# ЁЯОЙ **Migration р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕бр╕Ър╕╣р╕гр╕Ур╣Мр╣Бр╕ер╣Йр╕з!**

## **тЬЕ р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Ар╕кр╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕зр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф:**

---

### **ЁЯЧДя╕П Database Migration**
- тЬЕ **р╕нр╕▒р╕Ыр╣Ар╕Бр╕гр╕Фр╕Хр╕▓р╕гр╕▓р╕З `units`** - р╣Ар╕Юр╕┤р╣Ир╕бр╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╣Гр╕лр╕бр╣Ир╕Др╕гр╕Ър╕Хр╕▓р╕б ERD
- тЬЕ **р╕кр╕гр╣Йр╕▓р╕Зр╕Хр╕▓р╕гр╕▓р╕З `owners`** - р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Ф
- тЬЕ **р╕кр╕гр╣Йр╕▓р╕Зр╕Хр╕▓р╕гр╕▓р╕З `tenants`** - р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓
- тЬЕ **р╕кр╕гр╣Йр╕▓р╕Зр╕Хр╕▓р╕гр╕▓р╕З `tenancy_history`** - р╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╣Ар╕Кр╣Ир╕▓
- тЬЕ **р╕кр╕гр╣Йр╕▓р╕Зр╕Хр╕▓р╕гр╕▓р╕З `rental_payments`** - р╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╕Др╣Ир╕▓р╣Ар╕Кр╣Ир╕▓
- тЬЕ **р╕кр╕гр╣Йр╕▓р╕З Indexes** - р╣Ар╕Юр╕┤р╣Ир╕бр╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╕Бр╕▓р╕гр╕Др╣Йр╕Щр╕лр╕▓
- тЬЕ **р╕кр╕гр╣Йр╕▓р╕З Foreign Keys** - р╕Др╕зр╕▓р╕бр╕кр╕▒р╕бр╕Юр╕▒р╕Щр╕Шр╣Мр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Хр╕▓р╕гр╕▓р╕З
- тЬЕ **Row Level Security** - р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Вр╣Йр╕нр╕бр╕╣р╕е

---

### **ЁЯТ╗ Application Code**
- тЬЕ **TypeScript Interfaces** - `lib/types/permissions.ts` р╣Бр╕ер╕░ `lib/types/units.ts`
- тЬЕ **Server Actions** - `lib/actions/units-actions.ts`
- тЬЕ **UI Components** - `app/(admin)/units/page.tsx` р╣Гр╕лр╕бр╣И
- тЬЕ **Migration Scripts** - `scripts/141_complete_migration_execution.sql`

---

### **ЁЯУЪ Documentation**
- тЬЕ **Migration Guide** - `MIGRATION_GUIDE.md`
- тЬЕ **Execution Guide** - `MIGRATION_EXECUTION_GUIDE.md`
- тЬЕ **SQL Scripts** - р╕Юр╕гр╣Йр╕нр╕бр╕гр╕▒р╕Щр╣Гр╕Щ Supabase

---

## **ЁЯЪА р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Хр╣Ир╕нр╣Др╕Ы:**

### **1. р╕гр╕▒р╕Щ Migration р╣Гр╕Щ Supabase**
```bash
# р╣Ар╕Ыр╕┤р╕Ф Supabase SQL Editor
# р╕Др╕▒р╕Фр╕ер╕нр╕Бр╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╕Ир╕▓р╕Б scripts/141_complete_migration_execution.sql
# р╕гр╕▒р╕Щ script р╣Гр╕Щ Supabase
```

### **2. р╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ъ**
- р╣Ар╕Вр╣Йр╕▓р╕лр╕Щр╣Йр╕▓ Units р╣Гр╕Щр╣Бр╕нр╕Ыр╕Юр╕ер╕┤р╣Ар╕Др╕Кр╕▒р╕Щ
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕кр╕Фр╕Зр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
- р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Фр╣Гр╕лр╕бр╣И
- р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╣Бр╕ер╕░р╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓

### **3. р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╣Гр╕лр╕бр╣И**
- **р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Фр╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ** - р╕Ыр╕гр╕░р╣Ар╕ар╕Ч, р╕Вр╕Щр╕▓р╕Ф, р╕лр╣Йр╕нр╕Зр╕Щр╕нр╕Щ/р╕Щр╣Йр╕│, р╕Чр╕╡р╣Ир╕Ир╕нр╕Фр╕гр╕Ц
- **р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕З** - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕З, р╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Ир╕зр╕б, р╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щр╕Бр╕▓р╕гр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕З
- **р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓** - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓, р╕кр╕▒р╕Нр╕Нр╕▓р╣Ар╕Кр╣Ир╕▓, р╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ
- **р╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╣Ар╕Кр╣Ир╕▓** - р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Бр╕▓р╕гр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕Ыр╕ер╕Зр╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓
- **р╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╕Др╣Ир╕▓р╣Ар╕Кр╣Ир╕▓** - р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щр╕гр╕▓р╕вр╣Ар╕Фр╕╖р╕нр╕Щ

---

## **ЁЯОп р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╣Гр╕лр╕бр╣Ир╕Чр╕╡р╣Ир╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ:**

### **ЁЯПа р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Ф**
- тЬЕ р╣Ар╕Юр╕┤р╣Ир╕бр╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Фр╣Гр╕лр╕бр╣Ир╕Юр╕гр╣Йр╕нр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ
- тЬЕ р╣Бр╕Бр╣Йр╣Др╕Вр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Ф
- тЬЕ р╕Фр╕╣р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Ф
- тЬЕ р╕Др╣Йр╕Щр╕лр╕▓р╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Фр╕Хр╕▓р╕бр╕лр╕бр╕▓р╕вр╣Ар╕ер╕В, р╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕З, р╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓
- тЬЕ р╕кр╣Ир╕Зр╕нр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Ыр╣Зр╕Щ CSV

### **ЁЯСд р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕З**
- тЬЕ р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╣Гр╕лр╕бр╣И
- тЬЕ р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕гр╣Ир╕зр╕б
- тЬЕ р╕Бр╕│р╕лр╕Щр╕Фр╕кр╕▒р╕Фр╕кр╣Ир╕зр╕Щр╕Бр╕▓р╕гр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕З
- тЬЕ р╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕З

### **ЁЯПа р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓**
- тЬЕ р╣Ар╕Юр╕┤р╣Ир╕бр╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓р╣Гр╕лр╕бр╣И
- тЬЕ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Ар╕Кр╣Ир╕▓р╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ
- тЬЕ р╕кр╕▒р╕Нр╕Нр╕▓р╣Ар╕Кр╣Ир╕▓
- тЬЕ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Йр╕╕р╕Бр╣Ар╕Йр╕┤р╕Щ

### **ЁЯУЛ р╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╣Ар╕Кр╣Ир╕▓**
- тЬЕ р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╣Ар╕Кр╣Ир╕▓
- тЬЕ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕▒р╕Нр╕Нр╕▓р╣Ар╕Кр╣Ир╕▓
- тЬЕ р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╣Ар╕Кр╣Ир╕▓

### **ЁЯТ░ р╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╕Др╣Ир╕▓р╣Ар╕Кр╣Ир╕▓**
- тЬЕ р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щр╕гр╕▓р╕вр╣Ар╕Фр╕╖р╕нр╕Щ
- тЬЕ р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░
- тЬЕ р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ

---

## **ЁЯФз р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓:**

### **р╕лр╕▓р╕Бр╕Юр╕Ър╕Ыр╕▒р╕Нр╕лр╕▓:**
1. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Supabase Logs** - р╕Фр╕╣ error messages
2. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Database** - р╕Фр╕╣р╕зр╣Ир╕▓р╕Хр╕▓р╕гр╕▓р╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
3. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Permissions** - р╕Фр╕╣р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Бр╕▓р╕гр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕З
4. **р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Чр╕╡р╕бр╕Юр╕▒р╕Тр╕Щр╕▓** - р╕Вр╕нр╕Др╕зр╕▓р╕бр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕н

### **р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ:**
```sql
-- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Хр╕▓р╕гр╕▓р╕Зр╣Гр╕лр╕бр╣И
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
  AND table_name IN ('owners', 'tenants', 'tenancy_history', 'rental_payments');

-- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е
SELECT COUNT(*) FROM units;
SELECT COUNT(*) FROM owners;
SELECT COUNT(*) FROM tenants;
```

---

## **ЁЯОЙ р╕кр╕гр╕╕р╕Ы:**

### **тЬЕ Migration р╕кр╕│р╣Ар╕гр╣Зр╕И!**
- **Database** - р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Гр╕лр╕бр╣Ир╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
- **Application** - р╣Вр╕Др╣Йр╕Фр╣Гр╕лр╕бр╣Ир╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
- **Documentation** - р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щ
- **Testing** - р╣Др╕бр╣Ир╕бр╕╡ linting errors

### **ЁЯЪА р╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ!**
р╕Др╕╕р╕Ур╕кр╕▓р╕бр╕▓р╕гр╕Ц:
1. **р╕гр╕▒р╕Щ Migration Script** р╣Гр╕Щ Supabase
2. **р╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ъ** р╕лр╕ер╕▒р╕З Migration
3. **р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╣Гр╕лр╕бр╣И** р╣Др╕Фр╣Йр╕Чр╕▒р╕Щр╕Чр╕╡
4. **р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕лр╣Йр╕нр╕Зр╕Кр╕╕р╕Ф** р╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щр╕Хр╕▓р╕б ERD

### **ЁЯОп р╕Ыр╕гр╕░р╣Вр╕вр╕Кр╕Щр╣Мр╕Чр╕╡р╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ъ:**
- **р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ** - р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ър╕Цр╣Йр╕зр╕Щр╕Хр╕▓р╕б ERD
- **р╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╕Фр╕╡р╕Вр╕╢р╣Йр╕Щ** - Indexes р╣Бр╕ер╕░ Foreign Keys
- **р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в** - Row Level Security
- **р╕Вр╕вр╕▓р╕вр╣Др╕Фр╣Йр╕Зр╣Ир╕▓р╕в** - р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Чр╕╡р╣Ир╕вр╕╖р╕Фр╕лр╕вр╕╕р╣Ир╕Щ

---

## **ЁЯУЮ р╕Бр╕▓р╕гр╕Вр╕нр╕Др╕зр╕▓р╕бр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕н:**

р╕лр╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Др╕зр╕▓р╕бр╕Кр╣Ир╕зр╕вр╣Ар╕лр╕ер╕╖р╕н:
1. р╕Фр╕╣ `MIGRATION_GUIDE.md` - р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
2. р╕Фр╕╣ `MIGRATION_EXECUTION_GUIDE.md` - р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╕гр╕▒р╕Щ Migration
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ `scripts/141_complete_migration_execution.sql` - Script р╕лр╕ер╕▒р╕Б
4. р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Чр╕╡р╕бр╕Юр╕▒р╕Тр╕Щр╕▓

---

**ЁЯОЙ Migration р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕бр╕Ър╕╣р╕гр╕Ур╣Мр╣Бр╕ер╣Йр╕з! р╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕гр╕░р╕Ър╕Ър╣Гр╕лр╕бр╣И!** ЁЯЪА
