# User Groups - ตารางสิทธิ์แบบละเอียด

## 📊 ตารางสิทธิ์กลุ่มผู้ใช้งาน (User Groups)

### ภาพรวมกลุ่มผู้ใช้ทั้งหมด

| ระดับสิทธิ์ | กลุ่มผู้ใช้งาน | สิทธิ์การเข้าถึง | ตัวอย่างหน้าที่ในระบบ |
|------------|---------------|-----------------|----------------------|
| **1. Super Admin** | ทีม IT / ผู้ให้บริการระบบ | ✅ จัดการทุกโมดูล<br>✅ เพิ่ม/ลบอาคาร<br>✅ สร้างผู้ใช้ / รีเซ็ตรหัสผ่าน | ตั้งค่าโครงสร้างอาคาร, สิทธิ์, สำรองข้อมูล |
| **2. Company Admin** | ผู้ดูแลบริษัทบริหารอาคาร | ✅ จัดการโครงการทั้งหมด<br>✅ ดูรายงานรวม<br>✅ จัดการผู้ใช้ข้ามโครงการ | ดูภาพรวมบริษัท, จัดการหลายโครงการ |
| **3. Project Admin (Juristic Manager)** | ผู้จัดการสำนักงานนิติบุคคล | ✅ เข้าถึงข้อมูลบัญชีทั้งหมด<br>✅ อนุมัติเอกสารการเงิน<br>✅ ดูรายงานสรุปทั้งหมด | ตรวจสอบรายงานรายเดือน, อนุมัติจ่ายเงิน, ออกงบ |
| **4. Accountant (เจ้าหน้าที่บัญชี)** | ฝ่ายบัญชี / การเงิน | ✅ บันทึกรายรับ-รายจ่าย<br>✅ สร้างใบแจ้งหนี้<br>✅ บันทึกการชำระเงิน<br>❌ ไม่ลบข้อมูล | บันทึกข้อมูลรายเดือน, พิมพ์ใบเสร็จ |
| **5. Committee (กรรมการอาคารชุด)** | กรรมการนิติบุคคล | 🔍 ดูรายงานเท่านั้น<br>🔍 ดูบัญชีสรุปและงบเดือน<br>📄 พิมพ์และส่งออกรายงาน | ตรวจสอบงบ / การใช้จ่าย |
| **6. Auditor (ผู้ตรวจสอบบัญชี)** | ผู้ตรวจสอบบัญชีภายนอก | 🔍 เข้าถึงข้อมูลเฉพาะงบการเงิน<br>🧾 ไม่มีสิทธิ์แก้ไข<br>📄 พิมพ์งบเท่านั้น | ตรวจสอบบัญชีประจำปี |
| **7. Support Staff (เจ้าหน้าที่ทั่วไป)** | เจ้าหน้าที่อาคารที่ไม่เกี่ยวบัญชี | ❌ ไม่มีสิทธิ์บัญชี<br>✅ เข้าถึงเฉพาะพัสดุ / แจ้งซ่อม / ประกาศ | ใช้ระบบอื่นร่วม เช่น พัสดุ, งานซ่อม |
| **8. Engineer (ช่างซ่อม)** | ช่างบำรุงรักษา | ✅ เฉพาะงานแจ้งซ่อม<br>✅ อัปเดตสถานะงาน | รับงาน, ปิดงาน, บันทึกการซ่อม |
| **9. Resident (ลูกบ้าน)** | เจ้าของห้อง / ผู้พักอาศัย | 🔍 ดูเฉพาะข้อมูลของตนเอง<br>💳 ชำระค่าบริการ<br>📄 ดูใบแจ้งหนี้ย้อนหลัง | ดูยอดค้าง, ดูใบเสร็จ, ดาวน์โหลด PDF |

---

## 📋 ตารางสิทธิ์แบบละเอียด

### **Accountant (เจ้าหน้าที่บัญชี)**

| โมดูล | เข้าเมนู | View | Add | Edit | Delete | Print | Export |
|-------|:--------:|:----:|:---:|:----:|:------:|:-----:|:------:|
| ออกบิล | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| การชำระเงิน | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| บันทึกรายรับ | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| บันทึกรายจ่าย | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| ผังบัญชี | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| สมุดรายวัน | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| สมุดบัญชีแยกประเภท | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| รายงานทางการเงิน | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| รายงาน | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| **Total Modules** | **9** | | | | | | |

**Summary:** เจ้าหน้าที่บัญชีเข้าถึง **9 โมดูลบัญชี** สามารถบันทึกข้อมูล แต่ไม่ลบ

---

### **Committee (กรรมการอาคารชุด)**

| โมดูล | เข้าเมนู | View | Add | Edit | Delete | Print | Export |
|-------|:--------:|:----:|:---:|:----:|:------:|:-----:|:------:|
| รายงาน | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| รายงานทางการเงิน | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| รายงานรายรับ | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| รายงานเปรียบเทียบงบ | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| การวิเคราะห์ข้อมูล | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| **Total Modules** | **5** | | | | | | |

**Summary:** กรรมการ**ดูได้อย่างเดียว** - เหมาะสำหรับการตรวจสอบและ oversight

---

### **Auditor (ผู้ตรวจสอบบัญชี)**

| โมดูล | เข้าเมนู | View | Add | Edit | Delete | Print | Export |
|-------|:--------:|:----:|:---:|:----:|:------:|:-----:|:------:|
| รายงานทางการเงิน | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| สมุดบัญชีแยกประเภท | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ✅ |
| สมุดรายวัน | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ❌ |
| ผังบัญชี | ✅ | ✅ | ❌ | ❌ | ❌ | ✅ | ❌ |
| **Total Modules** | **4** | | | | | | |

**Summary:** ผู้ตรวจสอบเข้าถึง**งบการเงินเท่านั้น** - Read-only + Print

---

### **Support Staff (เจ้าหน้าที่ทั่วไป)**

| โมดูล | เข้าเมนู | View | Add | Edit | Delete | Print | Export |
|-------|:--------:|:----:|:---:|:----:|:------:|:-----:|:------:|
| จัดการพัสดุ | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| งานแจ้งซ่อม | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ✅ |
| ประกาศ | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ❌ |
| เอกสารและไฟล์ | ✅ | ✅ | ✅ | ✅ | ❌ | ❌ | ✅ |
| **Total Modules** | **4** | | | | | | |

**Summary:** เจ้าหน้าที่ทั่วไป**ไม่เข้าบัญชี** - เฉพาะงานปฏิบัติการ

---

## 🎯 การใช้งาน User Groups

### **ตัวอย่างที่ 1: มอบหมาย User เข้า Accountant Group**

```
Project Admin
  ↓
เข้า "จัดการทีมงาน"
  ↓
เพิ่มทีมงาน:
  - Email: accountant@project.com
  - ชื่อ: John Accountant
  - ตำแหน่ง: Staff
  ↓
เข้า "กลุ่มผู้ใช้งาน"
  ↓
เลือก User: John Accountant
  ↓
มอบหมายเข้ากลุ่ม: "เจ้าหน้าที่บัญชี"
  ↓
✅ John จะได้สิทธิ์:
  - เข้า 9 โมดูลบัญชี
  - บันทึกรายรับ-รายจ่าย
  - สร้างบิล
  - ไม่ลบข้อมูล
```

---

### **ตัวอย่างที่ 2: มอบหมาย Resident เข้า Committee Group**

```
Project Admin
  ↓
มี Resident ห้อง 505 (นาย A)
  ↓
นาย A เป็นกรรมการอาคาร
  ↓
เข้า "กลุ่มผู้ใช้งาน"
  ↓
เลือก User: นาย A (Resident 505)
  ↓
มอบหมายเข้ากลุ่ม: "กรรมการอาคารชุด"
  ↓
✅ นาย A จะได้สิทธิ์เพิ่ม:
  - ดูรายงานทางการเงิน
  - ดูการวิเคราะห์ข้อมูล
  - พิมพ์และส่งออกรายงาน
  - ยังคงเป็น Resident (ดูข้อมูลห้องตนเอง)
  + สิทธิ์พิเศษเพื่อตรวจสอบงบ
```

---

### **ตัวอย่างที่ 3: Auditor ภายนอก**

```
Project Admin
  ↓
เพิ่มผู้ใช้ชั่วคราว:
  - Email: auditor@external.com
  - ชื่อ: External Auditor
  - ตำแหน่ง: Resident (ไม่มีห้อง)
  ↓
มอบหมายเข้ากลุ่ม: "ผู้ตรวจสอบบัญชี"
  ↓
✅ Auditor จะได้สิทธิ์:
  - เข้า 4 โมดูลงบการเงิน
  - ดูอย่างเดียว (Read-only)
  - พิมพ์งบได้
  - ไม่สามารถแก้ไข/ส่งออกบางอย่าง
  ↓
หลังตรวจสอบเสร็จ:
  → ปิดใช้งาน account
```

---

## 📊 เปรียบเทียบกลุ่มผู้ใช้

### **จำนวนโมดูลที่เข้าถึงได้:**

| Group | Modules | Main Focus | Can Edit | Can Delete |
|-------|:-------:|------------|:--------:|:----------:|
| **Project Admin** | 28 | ทุกอย่าง | ✅ Most | ❌ Bills/Projects |
| **Accountant** | 9 | บัญชี/การเงิน | ✅ Yes | ❌ No |
| **Committee** | 5 | รายงาน | ❌ No | ❌ No |
| **Auditor** | 4 | งบการเงิน | ❌ No | ❌ No |
| **Support Staff** | 4 | Operations | ✅ Yes | ❌ No |
| **Engineer** | 1 | งานซ่อม | ✅ Yes | ❌ No |
| **Resident** | 7 | Own data | ❌ No | ❌ No |

---

## 🎨 UI Design: User Groups Management

### **หน้า User Groups Management**

```
┌──────────────────────────────────────────────────────────┐
│ จัดการกลุ่มผู้ใช้งาน                  [สร้างกลุ่มใหม่]  │
│ กำหนดสิทธิ์แบบกลุ่ม                                      │
├──────────────────────────────────────────────────────────┤
│                                                           │
│ 📊 กลุ่มผู้ใช้งานที่มีอยู่ (4 กลุ่ม)                    │
│                                                           │
│ ┌───────────────────────────────────────────────────────┐│
│ │ กลุ่ม              │ จำนวน │ โมดูล │ จัดการ         ││
│ ├───────────────────────────────────────────────────────┤│
│ │ 💼 เจ้าหน้าที่บัญชี │ 3 คน  │ 9     │ [ดู][แก้][สิทธิ์]││
│ │ 🛡️ กรรมการอาคาร    │ 5 คน  │ 5     │ [ดู][แก้][สิทธิ์]││
│ │ 🔍 ผู้ตรวจสอบบัญชี │ 1 คน  │ 4     │ [ดู][แก้][สิทธิ์]││
│ │ 👨‍🔧 เจ้าหน้าที่ทั่วไป│ 7 คน  │ 4     │ [ดู][แก้][สิทธิ์]││
│ └───────────────────────────────────────────────────────┘│
└──────────────────────────────────────────────────────────┘
```

### **Dialog: ดู/แก้ไขสิทธิ์กลุ่ม**

```
┌──────────────────────────────────────────────┐
│ สิทธิ์กลุ่ม: เจ้าหน้าที่บัญชี              │
│ (3 คน: John, Jane, Bob)                     │
├──────────────────────────────────────────────┤
│                                               │
│ เลือกโมดูลและสิทธิ์:                        │
│                                               │
│ ✅ ออกบิล                                    │
│    ✅ View ✅ Add ✅ Edit ❌ Delete            │
│    ✅ Print ✅ Export                         │
│                                               │
│ ✅ การชำระเงิน                               │
│    ✅ View ✅ Add ✅ Edit ❌ Delete            │
│    ✅ Print ✅ Export                         │
│                                               │
│ ✅ บันทึกรายรับ                              │
│    ✅ View ✅ Add ✅ Edit ❌ Delete            │
│    ✅ Print ✅ Export                         │
│                                               │
│ ✅ บันทึกรายจ่าย                             │
│    ✅ View ✅ Add ✅ Edit ❌ Delete            │
│    ✅ Print ✅ Export                         │
│                                               │
│ ❌ จัดการพัสดุ (ไม่อนุญาต)                   │
│ ❌ งานแจ้งซ่อม (ไม่อนุญาต)                  │
│                                               │
│ [บันทึก] [ยกเลิก]                            │
└──────────────────────────────────────────────┘
```

---

## 🔐 ประโยชน์ของ User Groups

### **1. Flexibility (ยืดหยุ่น)**
```
✅ สร้างกลุ่มตามหน้าที่จริง
✅ มอบหมายสิทธิ์แบบ batch
✅ แก้ไขสิทธิ์ทีละกลุ่ม
✅ เพิ่ม/ลบ members ได้ง่าย
```

### **2. Consistency (สม่ำเสมอ)**
```
✅ เจ้าหน้าที่บัญชีทุกคนได้สิทธิ์เดียวกัน
✅ ไม่ต้องตั้งสิทธิ์ทีละคน
✅ ลด human error
```

### **3. Scalability (ขยายได้)**
```
✅ เพิ่ม user ใหม่ → เพิ่มเข้ากลุ่ม → ได้สิทธิ์ทันที
✅ แก้สิทธิ์กลุ่ม → members ทุกคนได้สิทธิ์ใหม่
✅ รองรับองค์กรขนาดใหญ่
```

### **4. Auditing (ตรวจสอบได้)**
```
✅ รู้ว่า user อยู่กลุ่มไหน
✅ รู้ว่ากลุ่มนั้นมีสิทธิ์อะไร
✅ ตรวจสอบ compliance
```

---

## 🎯 ตัวอย่าง Use Cases

### **Use Case 1: บริษัทมีฝ่ายบัญชี 5 คน**

**วิธีเดิม (ไม่มี Groups):**
```
1. สร้าง User 1 → เลือกโมดูลทีละอัน (9 โมดูล)
2. สร้าง User 2 → เลือกโมดูลทีละอัน (9 โมดูล)
3. สร้าง User 3 → เลือกโมดูลทีละอัน (9 โมดูล)
4. สร้าง User 4 → เลือกโมดูลทีละอัน (9 โมดูล)
5. สร้าง User 5 → เลือกโมดูลทีละอัน (9 โมดูล)
= 45 การตั้งค่า ❌
```

**วิธีใหม่ (มี Groups):**
```
1. สร้าง User 1, 2, 3, 4, 5
2. เพิ่มทั้ง 5 คนเข้ากลุ่ม "เจ้าหน้าที่บัญชี"
= 5 การตั้งค่า ✅
```

---

### **Use Case 2: เพิ่มโมดูลใหม่ให้กลุ่มบัญชี**

**วิธีเดิม:**
```
แก้ไขสิทธิ์ทีละคน (5 คน) ❌
```

**วิธีใหม่:**
```
แก้ไขสิทธิ์กลุ่ม "เจ้าหน้าที่บัญชี" → ทุกคนได้สิทธิ์ทันที ✅
```

---

## 📁 ไฟล์ที่จะสร้าง

1. `scripts/014_user_groups.sql` - Database schema ✅
2. `lib/types/user-groups.ts` - TypeScript types ✅
3. `lib/actions/user-group-actions.ts` - Server actions
4. `app/(admin)/user-groups/page.tsx` - User Groups management UI
5. `components/user-group-selector.tsx` - Component สำหรับเลือกกลุ่ม
6. `USER_GROUPS_GUIDE.md` - คู่มือการใช้งาน

---

## 🚀 ต้องการให้พัฒนาต่อไหม?

ฉันพร้อมสร้าง:
1. ✨ **หน้า User Groups Management** - จัดการกลุ่มและสิทธิ์
2. ✨ **Permission Matrix UI** - กำหนดสิทธิ์แบบ visual
3. ✨ **Group Assignment** - เพิ่ม/ลบ members
4. ✨ **Template Groups** - 4 กลุ่มพื้นฐานพร้อมใช้

ต้องการให้สร้างต่อไหมครับ? 🎯
