# üîß **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Logic ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏ä‡∏∏‡∏î**

## **‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö:**
```
‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏û‡∏±‡∏Å‡πÄ‡∏≠‡∏á (owner_occupies = true) 
‡πÅ‡∏ï‡πà‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô "‡∏ß‡πà‡∏≤‡∏á" (vacant)
```

## **‚úÖ ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**

### **üîç ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Logic ‡πÄ‡∏î‡∏¥‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `unit.current_owner && unit.current_owner.owner_occupies` ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡∏Å‡∏£‡∏ì‡∏µ
- ‡πÑ‡∏°‡πà‡∏°‡∏µ fallback ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ owner ‡πÅ‡∏ï‡πà owner_occupies = false
- Logic ‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (priority)

### **üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç logic ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏ì‡∏µ owner exists ‡πÅ‡∏ï‡πà owner_occupies = false
- ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö owner_occupies ‡∏Å‡πà‡∏≠‡∏ô tenant status

---

## **üéØ Logic ‡πÉ‡∏´‡∏°‡πà (4 Priority Levels):**

### **Priority 1: Special Statuses**
```typescript
// ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß, ‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á, ‡∏à‡∏≠‡∏á
if (unit.status === 'sold') return 'sold'
if (unit.status === 'maintenance') return 'maintenance'
if (unit.status === 'reserved') return 'reserved'
```

### **Priority 2: Owner Occupies**
```typescript
// ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏û‡∏±‡∏Å‡πÄ‡∏≠‡∏á
if (unit.current_owner && unit.current_owner.owner_occupies) {
  if (!unit.current_tenant) {
    return 'owner_occupied'  // ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤
  }
  if (unit.current_tenant.status === 'active') {
    return 'rented'  // ‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ active
  }
  return 'owner_occupied'  // ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏≠‡∏á ‡πÅ‡∏ï‡πà tenant inactive
}
```

### **Priority 3: Tenant Status**
```typescript
// ‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤
if (unit.current_tenant) {
  if (tenantStatus === 'active') return 'rented'
  if (tenantStatus === 'terminated') return 'terminated'
  if (tenantStatus === 'inactive' || 'pending') return 'vacant'
}
```

### **Priority 4: Default**
```typescript
// ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏°‡∏µ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏û‡∏±‡∏Å‡πÄ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤
if (unit.current_owner && !unit.current_owner.owner_occupies) {
  return 'vacant'  // ‡∏ß‡πà‡∏≤‡∏á (‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πà‡∏≤)
}
return 'vacant'  // ‡πÑ‡∏°‡πà‡∏°‡∏µ owner ‡∏Å‡πá‡∏ß‡πà‡∏≤‡∏á
```

---

## **üìä ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:**

### **‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏û‡∏±‡∏Å‡πÄ‡∏≠‡∏á**
```
Unit: A-101
Owner: ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ (owner_occupies = true)
Tenant: ‡πÑ‡∏°‡πà‡∏°‡∏µ
Result: "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏≠‡∏á" ‚úÖ
```

### **‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏û‡∏±‡∏Å‡πÄ‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤**
```
Unit: A-102
Owner: ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏õ‡∏≠‡∏á (owner_occupies = false)
Tenant: ‡πÑ‡∏°‡πà‡∏°‡∏µ
Result: "‡∏ß‡πà‡∏≤‡∏á" ‚úÖ
```

### **‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 3: ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏û‡∏±‡∏Å‡πÄ‡∏≠‡∏á ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ active**
```
Unit: A-103
Owner: ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏®‡∏£‡∏µ (owner_occupies = true)
Tenant: ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå (active)
Result: "‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤" ‚úÖ
```

### **‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 4: ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏û‡∏±‡∏Å‡πÄ‡∏≠‡∏á ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ inactive**
```
Unit: A-104
Owner: ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏û‡∏á‡∏©‡πå (owner_occupies = true)
Tenant: ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏û‡∏• (inactive)
Result: "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏≠‡∏á" ‚úÖ
```

---

## **üéØ Flow ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì:**

```
START
  ‚Üì
Priority 1: Special Statuses
  ‚îú‚îÄ sold ‚Üí "‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß"
  ‚îú‚îÄ maintenance ‚Üí "‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á"
  ‚îî‚îÄ reserved ‚Üí "‡∏à‡∏≠‡∏á"
  ‚Üì
Priority 2: Owner Occupies
  ‚îú‚îÄ owner_occupies = true + no tenant ‚Üí "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏≠‡∏á"
  ‚îú‚îÄ owner_occupies = true + tenant active ‚Üí "‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤"
  ‚îî‚îÄ owner_occupies = true + tenant inactive ‚Üí "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏≠‡∏á"
  ‚Üì
Priority 3: Tenant Status
  ‚îú‚îÄ tenant active ‚Üí "‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤"
  ‚îú‚îÄ tenant terminated ‚Üí "‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤"
  ‚îî‚îÄ tenant inactive/pending ‚Üí "‡∏ß‡πà‡∏≤‡∏á"
  ‚Üì
Priority 4: Default
  ‚îú‚îÄ owner exists + owner_occupies = false ‚Üí "‡∏ß‡πà‡∏≤‡∏á"
  ‚îî‚îÄ no owner ‚Üí "‡∏ß‡πà‡∏≤‡∏á"
END
```

---

## **‚ö†Ô∏è ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á:**

### **üîí ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:**
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `owner_occupies` ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ boolean ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ current_owner ‡πÅ‡∏•‡∏∞ current_tenant ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ tenant.status ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô active, inactive, terminated, ‡∏´‡∏£‡∏∑‡∏≠ pending

### **üìä ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:**
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢ `owner_occupies = true` ‚Üí ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏≠‡∏á"
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `owner_occupies` ‚Üí ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ ‚Üí ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤"

---

## **üéâ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:**

### **‚úÖ ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:**
- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å owner_occupies ‡πÅ‡∏•‡∏∞ tenant status
- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏≠‡∏á" ‡πÄ‡∏°‡∏∑‡πà‡∏≠ owner_occupies = true
- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏ß‡πà‡∏≤‡∏á" ‡πÄ‡∏°‡∏∑‡πà‡∏≠ owner_occupies = false
- Logic ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

### **üöÄ ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**
- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
- ‡∏Å‡∏£‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ä‡∏∏‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
- ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏ä‡∏∏‡∏î
- ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏ä‡∏∏‡∏î

---

## **üéØ ‡∏™‡∏£‡∏∏‡∏õ:**

### **‚úÖ ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1. **‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏¥‡∏î** - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß
2. **Logic ‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô** - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß
3. **‡πÑ‡∏°‡πà‡∏°‡∏µ fallback** - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß

### **üöÄ Logic ‡πÉ‡∏´‡∏°‡πà:**
- ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (4 levels)
- ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏∏‡∏Å‡∏Å‡∏£‡∏ì‡∏µ
- ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢

---

**üéØ Logic ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏ä‡∏∏‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!** üöÄ
