# âœ… à¸ªà¸£à¸¸à¸›à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚à¸«à¸™à¹‰à¸² Login

## ğŸ”„ à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™

### à¹€à¸”à¸´à¸¡ (à¸à¹ˆà¸­à¸™à¹à¸à¹‰à¹„à¸‚)
- **Input:** à¹€à¸¥à¸‚à¸«à¹‰à¸­à¸‡ (Room Number)
- **Authentication:** à¹€à¸Šà¹‡à¸„à¸ˆà¸²à¸à¸•à¸²à¸£à¸²à¸‡ `units` à¸”à¹‰à¸§à¸¢à¹€à¸¥à¸‚à¸«à¹‰à¸­à¸‡ + password
- **Function:** `signInResidentSimple`

### à¹ƒà¸«à¸¡à¹ˆ (à¸«à¸¥à¸±à¸‡à¹à¸à¹‰à¹„à¸‚)
- **Input:** à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰ (Username)
- **Authentication:** à¹ƒà¸Šà¹‰ Supabase Auth à¸”à¹‰à¸§à¸¢ email/username + password
- **Function:** `signInResidentSecure`

## ğŸ“ à¸§à¸´à¸˜à¸µà¸à¸²à¸£ Login

### à¸ªà¸³à¸«à¸£à¸±à¸šà¸¥à¸¹à¸à¸šà¹‰à¸²à¸™

**à¸à¸£à¸“à¸µà¸—à¸µà¹ˆ 1: Username à¹„à¸¡à¹ˆà¸¡à¸µ @**
```
Username: ADD
Password: 12345678
â†’ à¸ˆà¸°à¸–à¸¹à¸à¹à¸›à¸¥à¸‡à¹€à¸›à¹‡à¸™ ADD@unizorn.local
```

**à¸à¸£à¸“à¸µà¸—à¸µà¹ˆ 2: à¸à¸£à¸­à¸ email à¹€à¸•à¹‡à¸¡**
```
Username: thirapong.t@gmail.com
Password: 12345678
â†’ à¹ƒà¸Šà¹‰ email à¸—à¸µà¹ˆà¸à¸£à¸­à¸à¸¡à¸²à¹€à¸¥à¸¢
```

## ğŸ”§ à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸‚à¸­à¸‡à¸£à¸°à¸šà¸š

1. **à¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥à¸£à¸°à¸šà¸š:**
   - à¸ªà¸£à¹‰à¸²à¸‡à¸£à¸«à¸±à¸ªà¹€à¸Šà¸´à¸ â†’ à¸ªà¹ˆà¸‡à¹ƒà¸«à¹‰à¸¥à¸¹à¸à¸šà¹‰à¸²à¸™

2. **à¸¥à¸¹à¸à¸šà¹‰à¸²à¸™:**
   - à¸£à¸±à¸šà¸£à¸«à¸±à¸ªà¹€à¸Šà¸´à¸ â†’ à¹„à¸›à¸—à¸µà¹ˆà¸«à¸™à¹‰à¸² Register
   - à¸•à¸±à¹‰à¸‡ username à¹à¸¥à¸° password à¹€à¸­à¸‡
   - à¸šà¸±à¸à¸Šà¸µà¸–à¸¹à¸à¸ªà¸£à¹‰à¸²à¸‡à¹ƒà¸™ Supabase Auth

3. **Login:**
   - à¹ƒà¸Šà¹‰ username + password à¸—à¸µà¹ˆà¸•à¸±à¹‰à¸‡à¹„à¸§à¹‰
   - à¹€à¸Šà¹‡à¸„à¸œà¹ˆà¸²à¸™ Supabase Auth
   - à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸«à¹‰à¸­à¸‡à¸ˆà¸²à¸ `units` table

## ğŸ¯ à¸‚à¹‰à¸­à¸”à¸µ

âœ… **à¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢à¸ªà¸¹à¸‡** - à¹ƒà¸Šà¹‰ Supabase Auth (hashed password)
âœ… **à¸¢à¸·à¸”à¸«à¸¢à¸¸à¹ˆà¸™** - Username à¸«à¸£à¸·à¸­ email à¸à¹‡à¹ƒà¸Šà¹‰à¹„à¸”à¹‰
âœ… **à¸‡à¹ˆà¸²à¸¢à¸•à¹ˆà¸­à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™** - à¸¥à¸¹à¸à¸šà¹‰à¸²à¸™à¸•à¸±à¹‰à¸‡ password à¹€à¸­à¸‡à¹„à¸”à¹‰

## ğŸ“Š Database Schema

```
auth.users (Supabase Auth)
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ email (VARCHAR)
â”œâ”€â”€ encrypted_password (TEXT)
â””â”€â”€ user_metadata
    â”œâ”€â”€ unit_number
    â”œâ”€â”€ user_type: 'resident'
    â””â”€â”€ username

public.units
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ unit_number (TEXT)
â”œâ”€â”€ user_id (UUID) â†’ references auth.users(id)
â””â”€â”€ owner_email (TEXT)
```

## ğŸš€ Flow Diagram

```
Login Flow:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User enters â”‚
â”‚ username +  â”‚
â”‚ password    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Transform username  â”‚
â”‚ to email            â”‚
â”‚ ADD â†’ ADD@unizorn.  â”‚
â”‚ local               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Auth       â”‚
â”‚ signInWithPassword  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Get unit info from  â”‚
â”‚ units table using   â”‚
â”‚ user_id             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Store in localStorageâ”‚
â”‚ & redirect to       â”‚
â”‚ dashboard           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› Troubleshooting

### à¸–à¹‰à¸² login à¹„à¸¡à¹ˆà¹„à¸”à¹‰

1. **à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š username:**
   - à¹ƒà¸Šà¹‰ username à¸—à¸µà¹ˆà¸•à¸±à¹‰à¸‡à¹„à¸§à¹‰à¸•à¸­à¸™à¸ªà¸£à¹‰à¸²à¸‡à¸šà¸±à¸à¸Šà¸µ
   - à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡: `ADD` à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `ADCD`

2. **à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š password:**
   - à¹ƒà¸Šà¹‰ password à¸—à¸µà¹ˆà¸•à¸±à¹‰à¸‡à¹„à¸§à¹‰à¸•à¸­à¸™à¸ªà¸£à¹‰à¸²à¸‡à¸šà¸±à¸à¸Šà¸µ
   - à¸•à¹‰à¸­à¸‡à¸•à¸£à¸‡à¸à¸±à¸šà¸—à¸µà¹ˆà¸à¸£à¸­à¸à¸•à¸­à¸™ register

3. **à¸”à¸¹ error message:**
   - à¸–à¹‰à¸²à¸šà¸­à¸ "Invalid credentials" = username/password à¸œà¸´à¸”
   - à¸–à¹‰à¸²à¸šà¸­à¸ "Unit information not found" = à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸«à¹‰à¸­à¸‡à¹ƒà¸™à¸£à¸°à¸šà¸š

4. **à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹ƒà¸™ Supabase:**
   - à¹„à¸›à¸—à¸µà¹ˆ Authentication â†’ Users
   - à¸«à¸² user à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¹„à¸§à¹‰
   - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸² email à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡

## âœ… Checklist

- [x] à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ input à¸ˆà¸²à¸ "à¹€à¸¥à¸‚à¸«à¹‰à¸­à¸‡" à¹€à¸›à¹‡à¸™ "à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰"
- [x] à¸­à¸±à¸›à¹€à¸”à¸• function à¸ˆà¸²à¸ `signInResidentSimple` à¹€à¸›à¹‡à¸™ `signInResidentSecure`
- [x] à¹€à¸à¸´à¹ˆà¸¡ logic à¹à¸›à¸¥à¸‡ username à¹€à¸›à¹‡à¸™ email
- [x] à¸¥à¸šà¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ reset password (à¹ƒà¸Šà¹‰à¸£à¸°à¸šà¸š reset à¸œà¹ˆà¸²à¸™ email à¹à¸—à¸™)
- [x] à¸­à¸±à¸›à¹€à¸”à¸• UI text

## ğŸ“ Support

à¸–à¹‰à¸²à¸¢à¸±à¸‡à¸¡à¸µà¸›à¸±à¸à¸«à¸²:
1. à¹à¸™à¸š screenshot à¸‚à¸­à¸‡à¸«à¸™à¹‰à¸² login
2. à¹à¸™à¸š error message (à¸–à¹‰à¸²à¸¡à¸µ)
3. à¸šà¸­à¸à¸§à¹ˆà¸² username à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸„à¸·à¸­à¸­à¸°à¹„à¸£

